# utils/generator.py

import random
from faker import Faker

from datetime import date

def generate_customers(n=100):
    fake = Faker('ru_RU')
    segments = [
        'Новичок', 'Классик', 'Гурман', 'Крепкий вкус', 'Фильтровик',
        'Премиум', 'Оптовик', 'Подарочный', 'Постоянный', 'Сезонный'
    ]
    roasts = ['Светлая', 'Средняя', 'Тёмная']
    coffee_types = ['Арабика', 'Бленд', 'Робуста']
    brew_methods = ['Френч-пресс', 'Воронка', 'Турка', 'Гейзер', 'Автомат']
    coffees = [
        "Бразилия Можиана", "Бразилия Сантос", "Колумбия Хуила", "Колумбия Супремо",
        "Эфиопия Иргачефф", "Эфиопия Сидамо", "Кения AA", "Кения AB",
        "Суматра Манделинг", "Суматра Линтонг", "Уганда Бугишу", "Гватемала Антигуа"
    ]
    sources = ["мобильное приложение", "веб-сайт"]
    customers = []
    for _ in range(n):
        first_name = fake.first_name()
        last_name = fake.last_name()
        patronymic = fake.middle_name()
        language = 'ru'
        birth_date_dt = fake.date_of_birth(minimum_age=18, maximum_age=65)
        birth_date = birth_date_dt.isoformat()
        segment = random.choice(segments)
        favorite_roast = random.choice(roasts)
        favorite_coffee_type = random.choice(coffee_types)
        favorite_coffee = random.choice(coffees)
        brew_method = random.choice(brew_methods)
        signup_date_dt = fake.date_between(start_date='-3y', end_date='-1y')
        signup_date = signup_date_dt.isoformat()
        last_purchase_dt = fake.date_between(start_date=signup_date_dt, end_date=date.today())
        last_purchase = last_purchase_dt.isoformat()
        last_coffee_bought = random.choice(coffees)
        discount = random.choice([0, 5, 10, 15, 20, 25, 30])
        email = "stas.krdpltsv+discount@gmail.com"
        total_orders = random.randint(1, 50)
        recommendations = ', '.join(random.sample(coffees, k=random.choice([2, 3])))
        order_source = random.choice(sources)
        customers.append((
            first_name, last_name, patronymic, language, birth_date,
            segment, favorite_roast, favorite_coffee_type, favorite_coffee,
            brew_method, signup_date, last_purchase, last_coffee_bought,
            discount, email, total_orders, recommendations, order_source
        ))
    return customers


def generate_prompts():
    return [
        ("День рождения",
         "Ты — маркетолог в e-commerce-компании, специализирующейся на зерновом кофе; подготовь письмо-поздравление "
         "с днём рождения для клиентов. Требования к теме письма, если заказ сделан через {order_source},"
         "если мобильное приложение - то длина темы письма не более 40 символов, "
         "если веб сайт - то длина темы письма не более 60 символов, используй дружелюбную "
         "персонализацию {first_name}; в теле (не более 200 слов) начни с тёплого обращения {first_name}, "
         "поздравь с днём рождения, предложи эксклюзивное преимущество (скидка {discount} или подарок при заказе), "
         "укажи срок действия акции - добавь неделю после дня рождения, закончи подписью команды с контактами"
         ),
        ("Письмо после покупки с кросс-селлом",
         "Ты — маркетолог e-commerce-магазина зернового кофе, и тебе нужно побудить клиента к повторной покупке. "
         "Требования к теме письма, если заказ сделан через {order_source},"
         "если мобильное приложение - то длина темы письма не более 40 символов, "
         "если веб сайт - то длина темы письма не более 60 символов, вырази благодарность и упоминание нового вкуса."
         "В теле письма (не более 200 слов) поблагодари {first_name} за заказ {last_purchase}, кратко охарактеризуй выбранный "
         "сорт, предложи новый товар из рекомендаций {recommendations}, подчеркни скидку {discount} на следующий заказ и "
         "завершай подписью команды с ссылками на соцсети"
         ),
        ("Активация неактивного клиента",
         "Ты — маркетолог кофейного бренда, задача — вернуть подписчика, который не открывал письма более 30 дней. "
         "Требования к теме письма, если заказ сделан через {order_source},"
         "если мобильное приложение - то длина темы письма не более 40 символов, "
         "если веб сайт - то длина темы письма не более 60 символов, спроси «Мы скучаем, {first_name}?». "
         "В теле письма (не более 200 слов) поприветствуй {first_name} тёплым напоминанием о себе, представь подборку "
         "лучших хитов продаж, предложи эксклюзивную скидку {discount}, добавь отзывы клиентов для социального "
         "доказательства, и подпишись от лица команды."
         ),
        ("Рождество",
         "Ты — маркетолог в интернет-магазине, специализирующейся на премиальном зерновом кофе, и тебе нужно создать "
         "тёплое рождественское письмо-предложение. Требования к теме письма, если заказ сделан через {order_source},"
         "если мобильное приложение - то длина темы письма не более 40 символов, "
         "если веб сайт - то длина темы письма не более 60 символов. Персонализированное с помощью {first_name}, "
         "где тело письма (не более 200 слов) начинается с поздравления {first_name} с Рождеством, рекомендует 3–4 сорта или "
         "наборы кофе с описанием вкусовых нот и способов приготовления, подчёркивает скидку {discount}, "
         "укажи срок действия акции - неделя после рождества"
         ),
        ("Универсальный промпт",
         "Ты — маркетолог интернет-магазина премиального зернового кофе; используя данные клиента {first_name} (язык {language}), "
         "дата рождения {birth_date}, любимая обжарка {favorite_roast}, любимый кофе {favorite_coffee}, "
         "метод заваривания {brew_method}, сведения о последнем заказе {last_purchase} и общем числе "
         "покупок {total_orders}, а также персональную скидку {discount}, рекомендации {recommendations} "
         "и платформу заказа {order_source}, сформируй персонализированное email-сообщение: Требования к теме письма, "
         "если заказ сделан через {order_source}, если мобильное приложение - то длина темы письма не более 40 символов, "
         "если веб сайт - то длина темы письма не более 60 символов — коротко и мотивирующе, отражающее индивидуальные "
         "предпочтения, и тело письма (не более 200 слов) — с обращением по имени, упоминанием любимой обжарки и метода "
         "заваривания, благодарностью за предыдущие заказы, описанием скидки {discount} и релевантных "
         "рекомендаций {recommendations}, призывом к действию с акцентом на выгоду и сроки, а также тёплой подписью команды."
         ),
    ]
